<div class="pt-4 d-flex justify-content-between">
  <p>COMPETENCY RELATED INFORMATION</p>
  <p class="flex-shrink-0">8 of 12</p>
</div>

<h1 class="pb-4">Confirm Competencies</h1>
<p class="w-75 mb-5">We derived the following competencies from the job description you provided. Please review and adjust as needed.</p>

<form [formGroup]="form">

  <app-form-wrapper classList="mb-2">
    <app-input-text id="threshold"
                    [control]="this.form.get(THRESHOLD_FIELD)"
                    [required]="true"
                    label="Match Threshold"
                    [placeholder]="0.45"
                    helpBlock="Enter a value between 0.1 and 0.75. Lower values yield more competency matches."
    ></app-input-text>
    <button class="btn btn-secondary" type="button" (click)="updateThreshold()">Update Threshold</button>
  </app-form-wrapper>

  <div class="form-row mb-4" [formArrayName]="ANNOTATED_SUBSTATEMENT_FORM_ARRAY_NAME" *ngFor="let substatementControl of substatementControls let i = index;">

    <div class="form-group flex-grow-1" [formGroupName]="i">
      <label class="font-weight-bold" [for]="'competency'+i">{{substatementControl.value.substatement}}</label>
      <div class="form-row">
        <div class="col-md-9">
          <select class="form-control form-control-lg mb-3 mb-md-0" [id]="'competency'+i"
                  (change)="substatementControl.value.selectedCompetencyOption = $event.target.value"
                  [value]="substatementControl.get(COMPETENCY_FORM_ARRAY_NAME)['controls'][0].value.competency.recommendationID"
          >
            <option *ngFor="let competencyControl of substatementControl.get(COMPETENCY_FORM_ARRAY_NAME)['controls'];"
                    [value]="competencyControl.value.competency.recommendationID"
            >{{competencyControl.value.competency.name}}</option>
            <option [value]="competencySelectOptions.NONE">None</option> <!-- Dont send anything -->
            <option [value]="competencySelectOptions.OTHER">Other</option><!-- Send new name & desc -->
          </select>

          <div class="competency-other mb-3 mb-md-0"
               *ngIf="substatementControl.value.selectedCompetencyOption === competencySelectOptions.OTHER"
          >
            <label class="font-weight-bold mt-3" [for]="'competencyName'+i">Competency Name</label>
            <input type="text" class="form-control form-control-lg" [id]="'competencyName'+i"
                   [value]="substatementControl.value.annotatedDescription"
                   (change)="substatementControl.value.annotatedDescription = $event.target.value"
                   placeholder="Competency Name"
            >
          </div>

          <div class="competency-other mb-3 mb-md-0"
               *ngIf="substatementControl.value.selectedCompetencyOption === competencySelectOptions.OTHER"
          >
            <label class="font-weight-bold mt-3" [for]="'competencyDescription'+i">Competency Description</label>
            <input type="text" class="form-control form-control-lg" [id]="'competencyDescription'+i"
                   [value]="substatementControl.value.annotatedName"
                   (change)="substatementControl.value.annotatedName = $event.target.value"
                   placeholder="Competency Description"
            >
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="d-flex justify-content-between pt-5">
    <button type="button" class="btn btn-lg text-primary d-flex align-items-center p-0"
            (click)="back()">
      <i class="fas fa-angle-left text-primary mr-3" style="font-size: 24px;"></i>
      Back
    </button>
    <button type="submit" class="btn btn-lg btn-primary" (click)="this.submit()">Next</button>
  </div>
</form>
